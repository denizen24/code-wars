## Вопрос 1
**Какие паттерны
распределенных
транзакций
знаешь?**

В распределенных системах управление транзакциями может быть сложным из-за необходимости координации между различными сервисами или компонентами. Существуют несколько паттернов, которые помогают справиться с этой задачей. Вот некоторые из наиболее известных паттернов распределенных транзакций:

### 1. Двухфазный коммит (2PC)

- Описание: Это классический протокол для достижения согласованности в распределенных системах. Он состоит из двух фаз:
    1. Фаза подготовки: Координатор отправляет запрос на подготовку всем участникам. Участники отвечают, готовы ли они зафиксировать транзакцию.
    2. Фаза фиксации: Если все участники готовы, координатор отправляет команду на фиксацию. Если кто-то не готов, происходит откат.
- Преимущества: Гарантирует атомарность транзакций.
- Недостатки: Может быть блокировка, если координатор выходит из строя. Кроме того, требует блокировок ресурсов, что может снизить производительность.

### 2. Трехфазный коммит (3PC)

- Описание: Это расширение 2PC, которое добавляет третью фазу для повышения надежности.
    1. Фаза подготовки: Как и в 2PC.
    2. Фаза предварительного коммита: Координатор отправляет запрос на предварительный коммит.
    3. Фаза фиксации: Если все участники подтвердили предварительный коммит, происходит фиксация.
- Преимущества: Уменьшает вероятность блокировки и повышает доступность.
- Недостатки: Более сложен в реализации и требует больше сообщений.

### 3. Согласование с помощью событий (Event Sourcing)

- Описание: Вместо хранения текущего состояния системы, система хранит последовательность событий, которые привели к этому состоянию. Это позволяет восстановить состояние системы в любой момент времени.
- Преимущества: Позволяет легко отслеживать изменения и восстанавливать состояние.
- Недостатки: Сложность в реализации и необходимость управления большим объемом данных.

### 4. Согласованность с помощью саги (Saga Pattern)

- Описание: Вместо глобальной транзакции, система разбивается на несколько локальных транзакций, каждая из которых выполняется последовательно. Если одна из транзакций не удалась, выполняются компенсирующие действия для отмены предыдущих транзакций.
- Преимущества: Более высокая доступность и отсутствие блокировок. Легче обрабатывать сбои.
- Недостатки: Более сложное управление состоянием и логикой отмены.

### 5. Транзакции с использованием CQRS (Command Query Responsibility Segregation)

- Описание: Разделяет операции записи (команды) и чтения (запросы) для улучшения производительности и масштабируемости. Записи могут обрабатываться с помощью транзакций, а чтения могут использовать кэширование или другие оптимизации.
- Преимущества: Улучшает производительность и масштабируемость.
- Недостатки: Увеличивает сложность архитектуры.

### 6. Distributed Transactions with Atomic Commit Protocols

- Описание: Использует различные протоколы для достижения атомарности в распределенных транзакциях, такие как Paxos или Raft.
- Преимущества: Обеспечивает согласованность в распределенных системах.
- Недостатки: Сложность реализации и требования к сетевой стабильности.

### 7. Messaging Patterns

- Распределенные системы часто используют асинхронные сообщения для обмена информацией между компонентами.
- Паттерны, такие как "Очередь запросов" и "Очередь ответов", могут использоваться для обеспечения доставки и обработки сообщений в распределенной среде.

### 8. Compensating Transaction
- Этот паттерн представляет собой способ отката распределенной транзакции, если что-то идет не так. Вместо того чтобы просто отменять операцию, он предпринимает действия, которые компенсируют уже выполненные шаги транзакции.


### Заключение

Выбор паттерна распределенных транзакций зависит от конкретных требований вашей системы, таких как доступность, согласованность, производительность и сложность. Каждый из этих паттернов имеет свои преимущества и недостатки, и понимание их поможет вам выбрать наиболее подходящий для вашей архитектуры. Если у вас есть дополнительные вопросы или хотите обсудить конкретные сценарии, дайте знать!